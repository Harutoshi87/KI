-- [II] SELECT문 - 조회

-- 1. SELECT 문장 작성법
SELECT * FROM TAB;      -- 현 계정이 가지고 있는 테이블 정보(실행 : ctrl + Enter)
SELECT * FROM DEPT;     -- DEPT 테이블의 모든 열, 모든 행
SELECT * FROM SALGRADE; -- SALGRADE 테이블의 모든 열, 모든 행
SELECT * FROM EMP;      -- EMP 테이블이 모든 열, 모든 행

-- 2. 특정 열만 출력
DESC EMP;
    -- EMP 테이블의 구조(NOT NULL : PRIMARY KEY; (n) :ANZAHL AN BUCHSTABEN)
SELECT EMPNO, ENAME, SAL, JOB FROM EMP; -- EMP 테이블의 SELECT절의 지정된 열만 출력
SELECT EMPNO AS "사 번", ENAME AS "이 름", SAL AS "급여", JOB AS "직책"
    FROM EMP; -- 열 이름에 별칭을 두는 경우 EX. 열 이름 [AS] 별칭'
SELECT EMPNO "사 번", ENAME "이 름", SAL "급여", JOB
    FROM EMP; -- 열 이름에 별칭을 두는 경우 EX. 열이름 "별칭', 열이름
SELECT EMPNO "사 번", ENAME 이름, SAL 급여, JOB
    FROM EMP; -- 별칭에 SPACE가 없는 경우는 따옴표 생략 가능

-- 3. 특정 행 출력 : WHERE절(조건절) -- 비교 연산자 : >, >=, <, <=, 같다(=), 다르다(!=, ^=, <>)
SELECT EMPNO 사번, ENAME 이름, SAL 급여 FROM EMP WHERE SAL=3000;
SELECT EMPNO NO, ENAME NAME, SAL FROM EMP WHERE SAL!=3000;
SELECT EMPNO NO, ENAME NAME, SAL FROM EMP WHERE SAL^=3000;
SELECT EMPNO NO, ENAME NAME, SAL FROM EMP WHERE SAL<>3000;
    -- 비교 연산자 숫자, 문자, 날짜형 모두 비교 가능
    
-- 4. WHERE절(조건절)에 논리 연산자 : AND OR NOT
    -- EX1. 급여가 2000이상 3000이하인 직원의 모든 필드
    SELECT * FROM EMP WHERE SAL>=2000 AND  SAL<=3000;
    -- EX2. 82년도에 입사한 사원의 모든 필드
    SELECT * FROM EMP WHERE HIREDATE>='82/01/01' AND HIREDATE<='82/12/31';
    
    -- 날짜 표기법 SETTING 변경(현재:RR/MM/DD)
    ALTER SESSION SET NLS_DATE_FORMAT = 'RR/MM/DD';
    
    SELECT * FROM EMP
        WHERE TO_CHAR(HIREDATE, 'RR-MM-DD')>='82-01-01' 
            AND TO_CHAR(HIREDATE, 'RR-MM-DD')<='82-12-31';
    -- EX3. 부서번호가 10이 아닌 직원의 모든 필드
    SELECT * FROM EMP WHERE DEPTNO != 10;
    SELECT * FROM EMP WHERE NOT DEPTNO != 10;
    
-- 5. 산술 연산자(SELECT절, WHERE절, ORDER BY절)
SELECT EMPNO, ENAME, SAL "예전월급", SAL*1.1 "현재월급" FROM EMP;
    -- EX1. 연봉이 10,000이상인 직원의 ENAME, SAL, 연봉(SAL*12) - 연봉 순
    SELECT ENAME, SAL, SAL*12 "ANNUALSAL" -- (해석 순서 3)
        FROM EMP                -- (해석 순서 1)
        WHERE SAL*12 > 10000    -- (해석 순서 2) WHERE절에는 별칭 사용 불가능!
        ORDER BY ANNUALSAL;     -- (해석 순서 4)
    -- 산술 연산의 결과는 NULL을 포함하면 결과도 NUL
    -- NVL(NULL일 수도 있는 필드명, 대체값)함수를 이용 : 필드명과 대체값은 타입이 일치해야! 
    -- EX2. 모든 직원의 이름, 월급, 상여, 연봉(SAL*12+COMM)
    SELECT ENAME, SAL, COMM, SAL*12+NVL(COMM, 0) 연봉 FROM EMP;
    -- EX3. 모든 사원의 ENAME, MGR(상사사번)을 출력 - 상사사번이 없으면 'CEO'출력
    SELECT ENAME, NVL(TO_CHAR(MGR), 'CEO') MGR FROM EMP;
    DESC EMP;
    
-- 6. 연결 연산자(||) : 필드 내용이나 문자를 연결
SELECT ENAME || '은(는)' || JOB FROM EMP;
    
-- 7. 중복 제거(DISTINCT)
SELECT DISTINCT JOB FROM EMP;
SELECT DISTINCT DEPTNO FROM EMP;